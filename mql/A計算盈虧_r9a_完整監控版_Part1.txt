/* 第一部分：代碼開頭到 OnInit() 之前 */

/* MQL4/MQL5 codes was generated by Forex-EABuilder 
 Author: Dennis 
 Date: Fri Nov 14 2025 20:07:38 GMT+0800
 整合網頁監控版本 v9.02
 */ 

#include <ChartObjects\ChartObjectsTxtControls.mqh>
#include <Controls\Label.mqh>
#include <Controls\Button.mqh>
#include <Controls\Edit.mqh>

#property copyright "Forex-EABuilder + Web Monitor"
#property link "http://www.forex-eabuilder.com"
#property version "9.02"
#property description "A計算盈虧_r9a A要求開始 MT5 + 網頁監控"
#property strict

// ==================== 原有參數 ====================
input  string  檔案頭ID = "A1";
input  string  備註_VPS位置 = "VPS0";
input  int  每日最大統計次數_要x2 = 200;
input  double  當港幣時轉換匯率 = 7.78;

input  string  __________TG及通知有關__________ = "=====TG及通知有關=====";
input  bool  TG通知1_每天成本打開 = true;
input  string  TG1_Token_每天成本 = "bot7920839003:AAE9OP_FVWLEw6d46l8qEg6eiGmlKeiKYBo";
input  string  TG1_ChatID_每天成本 = "7482711333";
input  bool  TG1_手數不相等時星星備注_打開 = true;
input  bool  TG通知2_每手成本過高警報 = true;
input  string  TG2_Token_警報 = "bot6492162382:AAEKsQWDUXc7cJw0pS1z_lqsHZ6HIFLpjpw";
input  string  TG2_ChatID_警報 = "1942176657";
input  string  TG_Link = "https://api.telegram.org";
input  int  每日TG通知盈虧 = 1;
input  int  Step4_IC時 = 23;
input  int  Step4_IC分_0to58 = 33;
input  double  每手成本超過多少通知 = -20;

// ==================== 網頁監控參數 ====================
input  string  __________網頁監控系統__________ = "=====網頁監控參數=====";
input  string  Monitor_API_URL = "http://192.168.31.206:8080/api";
input  string  Monitor_API_KEY = "secret_key_2025_9093942525abcdxyz_";
input  string  Monitor_NodeID = "A1_VPS0";
input  int  Monitor_HeartbeatMinutes = 15;
input  bool  Monitor_AutoSend = true;

// ==================== 網頁監控全域變數 ====================
datetime g_lastMonitorHeartbeat = 0;
bool g_dataSentToday = false;

/* 請將此檔案內容複製到 Part2、Part3 中，然後合併成一個完整的 .mq5 檔案 */
